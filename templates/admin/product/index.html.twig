{% extends 'base.html.twig' %}

{% block title %}Back-Office{% endblock %}

{% block body %}
<h1 style="text-align:center; margin:20px 0;">Back-Office</h1>

{% for message in app.flashes('success') %}
  <div style="background:#d4edda; padding:10px; border-radius:6px; margin:10px 0;">
    {{ message }}
  </div>
{% endfor %}

{# Bloc AJOUT (bouton vers /admin/product/new) #}
<div style="border:1px solid #ddd; padding:20px; border-radius:10px; background:#f8d7da; margin-bottom:25px; display:flex; gap:20px; align-items:center;">
  <div style="width:140px; height:140px; border:1px dashed #888; display:flex; align-items:center; justify-content:center;">
    Image
  </div>

  <div style="flex:1; display:flex; flex-wrap:wrap; gap:15px;">
    <div><strong>Nom</strong><br><input disabled style="width:120px;"></div>
    <div><strong>Prix</strong><br><input disabled style="width:120px;"></div>

    <div><strong>Stock XS</strong><br><input disabled style="width:80px;"></div>
    <div><strong>Stock S</strong><br><input disabled style="width:80px;"></div>
    <div><strong>Stock M</strong><br><input disabled style="width:80px;"></div>
    <div><strong>Stock L</strong><br><input disabled style="width:80px;"></div>
    <div><strong>Stock XL</strong><br><input disabled style="width:80px;"></div>
  </div>

  <a href="{{ path('admin_product_new') }}"
     style="padding:12px 30px; background:white; border:1px solid #222; border-radius:8px; text-decoration:none; font-weight:bold;">
     AJOUTER
  </a>
</div>

{# Liste produits #}
{% for p in products %}
  <div style="border:1px solid #ddd; padding:20px; border-radius:10px; margin-bottom:18px; display:flex; gap:20px; align-items:center;">
    <div style="width:140px; height:140px; border:1px dashed #888; overflow:hidden; display:flex; align-items:center; justify-content:center;">
      {% if p.image %}
        <img src="{{ asset(p.image) }}" alt="{{ p.name }}" style="width:100%; height:100%; object-fit:cover;">
      {% else %}
        Image
      {% endif %}
    </div>

    <div style="flex:1; display:flex; flex-wrap:wrap; gap:15px;">
      <div><strong>Nom</strong><br><input disabled value="{{ p.name }}" style="width:120px;"></div>
      <div><strong>Prix</strong><br><input disabled value="{{ p.price }}" style="width:120px;"></div>

      <div><strong>Stock XS</strong><br><input disabled value="{{ p.stockXs ?? 0 }}" style="width:80px;"></div>
      <div><strong>Stock S</strong><br><input disabled value="{{ p.stockS ?? 0 }}" style="width:80px;"></div>
      <div><strong>Stock M</strong><br><input disabled value="{{ p.stockM ?? 0 }}" style="width:80px;"></div>
      <div><strong>Stock L</strong><br><input disabled value="{{ p.stockL ?? 0 }}" style="width:80px;"></div>
      <div><strong>Stock XL</strong><br><input disabled value="{{ p.stockXl ?? 0 }}" style="width:80px;"></div>
    </div>

    <div style="display:flex; gap:10px;">
      <form method="post" action="{{ path('admin_product_delete', {id: p.id}) }}">
        <input type="hidden" name="_token" value="{{ csrf_token('delete_product_' ~ p.id) }}">
        <button type="submit"
                style="padding:12px 22px; background:white; border:1px solid #222; border-radius:8px; font-weight:bold;">
          SUPPRIMER
        </button>
      </form>

      <a href="{{ path('admin_product_edit', {id: p.id}) }}"
         style="padding:12px 22px; background:white; border:1px solid #222; border-radius:8px; text-decoration:none; font-weight:bold;">
        MODIFIER
      </a>
    </div>
  </div>
{% else %}
  <p>Aucun produit.</p>
{% endfor %}
{% endblock %}
